<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
<link rel="shortout icon" href="../tzxyb.ico">
<style>
*{
	margin:0; 
	padding:0;
	list-style:none;
}
.wrap{
	width:100%;
}
.wrap header,.wrap footer{
	width:100%; 
	height:40px;
	line-height:40px;
	background:#399;
	text-align:center;
	font-size:20px;
	font-family:微软雅黑;
	font-weight:bold;
	color:#fff;
}
.wrap footer{
	position:fixed;
	left:0;
	bottom:0;
}
.wrap section{
 	width:100%;
	overflow:hidden;
}
.refresh_box{
	width:100%;
	text-align:center;
	height:0;
	overflow:hidden;
}
.news_box{
	width:400%;
	-webkit-transform:translate3d(0,0,0);
}
.news_box dl{
	width:25%;
	float:left;
	text-align:center;
}
dl dt{
	height:50px;
	line-height:50px;
	background:#ccc;
	font-family:微软雅黑;
	font-weight:bold;
}
dl dd{
	height:30px;
	line-height:30px;
}
</style>
<script>
document.addEventListener('DOMContentLoaded',function(){
	var oWrap = document.querySelector('.wrap');
	var oRe = document.querySelector('.refresh_box');
	var oNews = document.querySelector('.news_box');
	var aDl = oNews.children;
	var x = 0;
	var y = 0;
	var iNow = 0;
	var dir = '';
	oWrap.addEventListener('touchstart',function(ev){
		var downX = ev.targetTouches[0].pageX;
		var downY = ev.targetTouches[0].pageY;
		var disX = downX-x;
		var disY = downY-y;
		function fnMove(ev){
			var moveX = ev.targetTouches[0].pageX;
			var moveY = ev.targetTouches[0].pageY;
			
			if(dir){
				if(dir=='lr'){
					x = moveX-disX;
					oNews.style.WebkitTransform = 'translate3d('+x+'px,0,0)';
				}else if(dir=='tb'){
					y = moveY-downY;
					if(y>80)y=80;
					oRe.style.height = y+'px';
				}
			}else{
				if(Math.abs(moveX-downX)>5){
					dir = 'lr';
				}else if(Math.abs(moveY-downY)>5){
					dir = 'tb';
				}
			}
		}
		function fnEnd(ev){
			document.removeEventListener('touchmove',fnMove,false);
			document.removeEventListener('touchend',fnEnd,false);
			
			
			if(dir=='lr'){
				var upX = ev.changedTouches[0].pageX;
				
				if(Math.abs(upX-downX)>50){
					if(downX>upX){
						iNow++;
						if(iNow==aDl.length){
							iNow = aDl.length-1;
						}
					}else if(downX<upX){
						iNow--;
						if(iNow<0){
							iNow = 0;
						}
					}
				}
				
				oNews.style.WebkitTransition = '.4s all ease';
				
				x = -iNow*aDl[0].offsetWidth;
				oNews.style.WebkitTransform = 'translate3d('+x+'px,0,0)';

			}else if(dir=='tb'){
				oRe.style.WebkitTransition = '.4s all ease';
				oRe.style.height = 0;
			}
			
			
			dir = '';
		}
		document.addEventListener('touchmove',fnMove,false);
		document.addEventListener('touchend',fnEnd,false);
		ev.preventDefault();
	},false);
},false);
</script>
</head>

<body>
	<div class="wrap">
		<header>header</header>
		<section>
			<div class="refresh_box">
				<img src="roller.gif" alt="" />
				<br />
				<span>下拉刷新</span>
			</div>
			<div class="news_box">
				<dl>
					<dt>娱乐新闻</dt>
					<dd>1111</dd>
					<dd>5454</dd>
					<dd>1111</dd>
					<dd>3232</dd>
					<dd>1111</dd>
					<dd>11fdfsdf11</dd>
					<dd>fdsf</dd>
					<dd>1111</dd>
					<dd>4343</dd>
				</dl>
				<dl>
					<dt>体育新闻</dt>
					<dd>1111</dd>
					<dd>5454</dd>
					<dd>1111</dd>
					<dd>3232</dd>
					<dd>1111</dd>
					<dd>11fdfsdf11</dd>
					<dd>fdsf</dd>
					<dd>1111</dd>
					<dd>4343</dd>
				</dl>
				<dl>
					<dt>科技新闻</dt>
					<dd>1111</dd>
					<dd>5454</dd>
					<dd>1111</dd>
					<dd>3232</dd>
					<dd>1111</dd>
					<dd>11fdfsdf11</dd>
					<dd>fdsf</dd>
					<dd>1111</dd>
					<dd>4343</dd>
				</dl>
				<dl>
					<dt>军事新闻</dt>
					<dd>1111</dd>
					<dd>5454</dd>
					<dd>1111</dd>
					<dd>3232</dd>
					<dd>1111</dd>
					<dd>11fdfsdf11</dd>
					<dd>fdsf</dd>
					<dd>1111</dd>
					<dd>4343</dd>
				</dl>
			</div>
		</section>
		<footer>footer</footer>
	</div>
</body>
</html>


















